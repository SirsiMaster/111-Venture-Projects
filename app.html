<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#F2F2F7">
    <title>Legacy - Guided End-of-Life Management</title>
    
    <!-- iOS PWA Meta -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Legacy">
    
    <!-- Styles -->
    <link rel="stylesheet" href="assets/css/legacy.css?v=5">
    <link rel="manifest" href="manifest.json">
    
    <!-- Phosphor Icons (Apple-like) -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
</head>
<body>
    <!-- Global Ambient Background (Persists across app) -->
    <div class="ambient-background">
        <div class="ambient-orb orb-1"></div>
        <div class="ambient-orb orb-2"></div>
        <div class="ambient-orb orb-3"></div>
    </div>

    <div class="app-shell">
        <!-- Desktop Sidebar (iPad Sidebar Style) -->
        <nav class="app-nav--desktop">
            <div class="app-logo">
                <i class="ph-fill ph-star-four" style="color: var(--accent-blue);"></i>
                Legacy
            </div>
            <div class="nav-links">
                <a class="nav-link active" data-view="dashboard">
                    <i class="ph ph-squares-four"></i>
                    Dashboard
                </a>
                <a class="nav-link" data-view="guided">
                    <i class="ph ph-path"></i>
                    The Guided Path
                </a>
                <a class="nav-link" data-view="tasks">
                    <i class="ph ph-check-circle"></i>
                    Master Checklist
                </a>
                <div class="nav-divider"></div>
                <a class="nav-link" data-view="timeline">
                    <i class="ph ph-calendar-blank"></i>
                    Timeline
                </a>
                <a class="nav-link" data-view="contacts">
                    <i class="ph ph-users"></i>
                    Contacts
                </a>
                <a class="nav-link" data-view="documents">
                    <i class="ph ph-files"></i>
                    Documents
                </a>
                <a class="nav-link" data-view="resources">
                    <i class="ph ph-books"></i>
                    Resources
                </a>
                <div class="nav-divider"></div>
                <a class="nav-link" href="index.html" style="color: var(--text-secondary);">
                    <i class="ph ph-house"></i>
                    Back to Home
                </a>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="app-main">
            <!-- iOS Navigation Bar -->
            <header class="app-header">
                <div class="header-leading">
                    <!-- Back button could go here -->
                </div>
                <div class="header-title-inline" id="header-title-inline">Dashboard</div>
                <div class="header-trailing">
                    <button class="icon-btn" onclick="app.openModal('modal-profile')"><i class="ph ph-gear"></i></button>
                </div>
            </header>

            <div class="view-container" id="main-scroll">
                <!-- Dynamic Content Injected Here -->
                
                <!-- VIEW: Dashboard (Home) -->
                <div id="view-dashboard" class="app-view active">
                    <!-- Injected via JS -->
                </div>

                <!-- VIEW: Guided Path -->
                <div id="view-guided" class="app-view"></div>

                <!-- VIEW: Resources -->
                <div id="view-resources" class="app-view">
                    <div class="ios-large-title"><h1>Library</h1></div>
                    <div class="resource-grid" id="resource-grid">
                        <!-- Injected via JS -->
                    </div>
                </div>

                <!-- VIEW: Tasks -->
                <div id="view-tasks" class="app-view">
                    <div class="ios-large-title">
                        <h1>All Tasks</h1>
                    </div>
                    <div id="tasks-list"></div>
                </div>
                
                <!-- VIEW: Timeline -->
                <div id="view-timeline" class="app-view">
                    <div class="ios-large-title"><h1>Timeline</h1></div>
                    <div class="timeline-container" id="timeline-list">
                        <!-- Injected via JS -->
                    </div>
                </div>

                <!-- VIEW: Contacts -->
                <div id="view-contacts" class="app-view">
                    <div class="ios-large-title">
                        <h1>Contacts</h1>
                        <button class="icon-btn" style="position: absolute; right: 20px; top: 20px;" onclick="app.openModal('modal-contact')"><i class="ph ph-plus"></i></button>
                    </div>
                    <div class="contacts-grid" id="contacts-grid">
                        <!-- Injected via JS -->
                    </div>
                </div>

                <!-- VIEW: Documents -->
                <div id="view-documents" class="app-view">
                    <div class="ios-large-title">
                        <h1>Documents</h1>
                        <button class="icon-btn" style="position: absolute; right: 20px; top: 20px;" onclick="app.openModal('modal-document')"><i class="ph ph-upload-simple"></i></button>
                    </div>
                    <div class="documents-list" id="documents-list">
                        <!-- Injected via JS -->
                    </div>
                </div>
                <!-- VIEW: Settings -->
                <div id="view-settings" class="app-view">
                    <div class="ios-large-title"><h1>Settings</h1></div>
                    <div class="ios-list-group">
                        <div class="ios-list-item" onclick="app.openModal('modal-profile')">
                            <div class="ios-content">
                                <div class="ios-title">Decedent Profile</div>
                                <div class="ios-subtitle">Edit Name, Dates, and Details</div>
                            </div>
                            <i class="ph ph-caret-right" style="color: var(--text-tertiary);"></i>
                        </div>
                        <div class="ios-list-item">
                            <div class="ios-content">
                                <div class="ios-title">Notifications</div>
                            </div>
                            <div class="ios-toggle checked"></div>
                        </div>
                    </div>
                    <div class="ios-list-group">
                        <div class="ios-list-item" style="color: var(--status-danger);" onclick="app.handleResetData()">
                            <div class="ios-content">
                                <div class="ios-title">Reset App Data</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Mobile Bottom Nav (iOS Tab Bar) -->
        <nav class="app-nav--mobile">
            <div class="mobile-tab active" data-view="dashboard">
                <i class="ph ph-squares-four"></i>
                <span>Home</span>
            </div>
            <div class="mobile-tab" data-view="guided">
                <i class="ph ph-path"></i>
                <span>Guide</span>
            </div>
            <div class="mobile-tab" data-view="tasks">
                <i class="ph ph-check-circle"></i>
                <span>Tasks</span>
            </div>
            <div class="mobile-tab" data-view="resources">
                <i class="ph ph-books"></i>
                <span>Library</span>
            </div>
        </nav>
    </div>

    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- MODALS -->
    
    <!-- Add Contact Modal -->
    <div id="modal-contact" class="modal-overlay">
        <div class="glass-modal">
            <div class="modal-header">
                <h2>Add Contact</h2>
                <button class="close-modal" onclick="app.closeModal('modal-contact')"><i class="ph-bold ph-x"></i></button>
            </div>
            <form id="form-contact" onsubmit="app.handleAddContact(event)">
                <div class="form-group">
                    <label class="form-label">Full Name</label>
                    <input type="text" name="name" class="glass-input" required placeholder="e.g. Jane Doe">
                </div>
                <div class="form-group">
                    <label class="form-label">Role</label>
                    <input type="text" name="role" class="glass-input" required placeholder="e.g. Estate Attorney">
                </div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" name="email" class="glass-input" placeholder="jane@example.com">
                </div>
                <div class="form-group">
                    <label class="form-label">Phone</label>
                    <input type="tel" name="phone" class="glass-input" placeholder="(555) 123-4567">
                </div>
                <button type="submit" class="molten-btn">Save Contact</button>
            </form>
        </div>
    </div>

    <!-- Upload Document Modal -->
    <div id="modal-document" class="modal-overlay">
        <div class="glass-modal">
            <div class="modal-header">
                <h2>Upload Document</h2>
                <button class="close-modal" onclick="app.closeModal('modal-document')"><i class="ph-bold ph-x"></i></button>
            </div>
            <form id="form-document" onsubmit="app.handleUploadDocument(event)">
                <div class="form-group">
                    <label class="form-label">Document Title</label>
                    <input type="text" name="title" class="glass-input" required placeholder="e.g. Death Certificate">
                </div>
                <div class="form-group">
                    <label class="form-label">Category</label>
                    <select name="type" class="glass-input">
                        <option value="Legal">Legal</option>
                        <option value="Financial">Financial</option>
                        <option value="Personal">Personal</option>
                        <option value="Medical">Medical</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">File</label>
                    <div style="border: 2px dashed rgba(255,255,255,0.1); border-radius: 12px; padding: 30px; text-align: center; cursor: pointer; transition: all 0.2s;" onclick="document.getElementById('file-input').click()">
                        <i class="ph-duotone ph-cloud-arrow-up" style="font-size: 32px; color: var(--tint-blue); margin-bottom: 8px;"></i>
                        <div style="font-size: 14px; color: var(--text-secondary);">Click to select file</div>
                    </div>
                    <input type="file" id="file-input" style="display: none;" onchange="alert('File selected: ' + this.files[0].name)">
                </div>
                <button type="submit" class="molten-btn">Upload to Vault</button>
            </form>
        </div>
    </div>

    <!-- Profile/Settings Modal -->
    <div id="modal-profile" class="modal-overlay">
        <div class="glass-modal">
            <div class="modal-header">
                <h2>Edit Profile</h2>
                <button class="close-modal" onclick="app.closeModal('modal-profile')"><i class="ph-bold ph-x"></i></button>
            </div>
            <form id="form-profile" onsubmit="app.handleUpdateProfile(event)">
                <div class="form-group">
                    <label class="form-label">Decedent Name</label>
                    <input type="text" id="input-decedent-name" class="glass-input">
                </div>
                <div class="form-group">
                    <label class="form-label">Date of Death</label>
                    <input type="date" id="input-dod" class="glass-input">
                </div>
                <button type="submit" class="molten-btn">Update Timeline</button>
            </form>
        </div>
    </div>

    <!-- Automation Console Modal -->
    <div id="modal-automation" class="modal-overlay">
        <div class="glass-modal">
            <div class="modal-header">
                <h2>Concierge Automation</h2>
            </div>
            <div class="console-log" id="automation-console">
                <!-- Logs injected here -->
            </div>
            <div id="automation-progress" style="height: 4px; background: rgba(255,255,255,0.1); border-radius: 2px; overflow: hidden; margin-bottom: 20px;">
                <div id="automation-bar" style="height: 100%; width: 0%; background: var(--status-success); transition: width 0.2s;"></div>
            </div>
            <p id="automation-status" style="text-align: center; color: var(--text-secondary); margin-bottom: 24px;">Initializing...</p>
            <button id="btn-close-automation" class="molten-btn" style="display: none;" onclick="app.closeModal('modal-automation')">Done</button>
        </div>
    </div>

    <!-- Scripts -->
    <script src="assets/js/mock-data.js?v=3"></script>
    <script src="assets/js/legacy.js?v=3"></script>
</body>
</html>